<!DOCTYPE html>
<html>
<head>
  <title>Shop Details - Ink Link</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #121212;
      color: #f1f1f1;
      margin: 0;
      padding: 0;
      background-image: linear-gradient(rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.85)), url('https://images.unsplash.com/photo-1585070824263-5733950f10d7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1770&q=80');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
    header {
      text-align: center;
      padding: 30px 0;
      background-color: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.4);
      position: relative;
      z-index: 10;
    }
    .logo {
      font-family: 'Permanent Marker', cursive;
      font-size: 3em;
      margin-bottom: 10px;
      color: #ffffff;
      text-shadow: 
        0 0 10px #ff0099,
        0 0 20px #ff0099;
    }
    nav {
      margin-top: 10px;
    }
    nav a {
      margin: 0 15px;
      color: #ffffff;
      text-decoration: none;
      font-weight: 500;
      font-size: 1.1em;
      position: relative;
      transition: all 0.3s;
    }
    nav a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -5px;
      left: 0;
      background-color: #ff0099;
      transition: width 0.3s ease;
    }
    nav a:hover {
      color: #ff0099;
    }
    nav a:hover::after {
      width: 100%;
    }
    
    .container {
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
    }
    
    .shop-header {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      margin-bottom: 40px;
      background-color: rgba(25, 25, 25, 0.8);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .shop-gallery {
      flex: 1;
      min-width: 300px;
      position: relative;
    }
    
    .shop-image {
      width: 100%;
      height: 400px;
      background-size: cover;
      background-position: center;
      position: relative;
    }
    
    .gallery-nav {
      position: absolute;
      bottom: 20px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    
    .gallery-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .gallery-dot.active {
      background-color: #ff0099;
      transform: scale(1.2);
      box-shadow: 0 0 10px rgba(255, 0, 153, 0.5);
    }
    
    .shop-info {
      flex: 1;
      min-width: 300px;
      padding: 30px;
    }
    
    .shop-name {
      font-size: 2.2em;
      margin: 0 0 15px 0;
      color: #ffffff;
      font-weight: 700;
      position: relative;
      display: inline-block;
    }
    
    .shop-name::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 60px;
      height: 3px;
      background: linear-gradient(to right, #ff0099, #ff6a00);
    }
    
    .badge-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 15px 0;
    }
    
    .featured-badge, .sponsored-badge {
      display: inline-block;
      padding: 6px 15px;
      border-radius: 20px;
      font-size: 0.85em;
      font-weight: 500;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
    }
    
    .featured-badge {
      background: linear-gradient(135deg, #ff0099, #9b36b6);
      color: white;
    }
    
    .sponsored-badge {
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      color: white;
    }
    
    .shop-rating {
      display: flex;
      align-items: center;
      margin: 15px 0;
      font-size: 1.3em;
      color: #ffcc00;
      font-weight: 600;
    }
    
    .shop-rating::before {
      content: 'â˜…';
      margin-right: 8px;
    }
    
    .shop-rating .review-count {
      margin-left: 10px;
      font-size: 0.8em;
      color: #cccccc;
      font-weight: 400;
    }
    
    .shop-location {
      color: #cccccc;
      margin-bottom: 15px;
      font-size: 1.1em;
    }
    
    .shop-description {
      color: #e0e0e0;
      line-height: 1.6;
      margin-bottom: 20px;
      font-size: 1.05em;
    }
    
    .detail-section {
      margin-top: 15px;
    }
    
    .detail-title {
      font-weight: 600;
      color: #ff0099;
      margin-bottom: 5px;
    }
    
    .detail-content {
      color: #e0e0e0;
      line-height: 1.6;
    }
    
    .hours-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 5px;
    }
    
    .hour-item {
      display: flex;
      flex-direction: column;
    }
    
    .day {
      font-weight: 500;
      color: #ffffff;
    }
    
    .time {
      color: #cccccc;
    }
    
    .contact-list, .amenities-list, .social-list {
      list-style: none;
      padding: 0;
      margin: 5px 0 15px 0;
    }
    
    .contact-list li, .amenities-list li {
      margin-bottom: 5px;
      display: flex;
      align-items: center;
    }
    
    .social-list li {
      display: inline-block;
      margin-right: 15px;
    }
    
    .social-link {
      color: #ffffff;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      transition: all 0.3s ease;
    }
    
    .social-link:hover {
      color: #ff0099;
      transform: translateY(-3px);
    }
    
    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 25px;
    }
    
    .action-button {
      padding: 12px 24px;
      border-radius: 30px;
      border: none;
      font-weight: 600;
      font-size: 1em;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }
    
    .primary-button {
      background: linear-gradient(135deg, #ff0099, #ff6a00);
      color: white;
      box-shadow: 0 6px 20px rgba(255, 0, 153, 0.3);
    }
    
    .primary-button:hover {
      background: linear-gradient(135deg, #ff0099, #ff3366);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(255, 0, 153, 0.4);
    }
    
    .secondary-button {
      background: linear-gradient(135deg, #614385, #516395);
      color: white;
      box-shadow: 0 6px 20px rgba(97, 67, 133, 0.3);
    }
    
    .secondary-button:hover {
      background: linear-gradient(135deg, #516395, #614385);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(97, 67, 133, 0.4);
    }
    
    .tabs {
      display: flex;
      margin: 40px 0 20px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .tab-button {
      padding: 15px 25px;
      background: none;
      border: none;
      color: #cccccc;
      font-size: 1.1em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      font-family: 'Poppins', sans-serif;
    }
    
    .tab-button:hover {
      color: #ffffff;
    }
    
    .tab-button.active {
      color: #ff0099;
    }
    
    .tab-button.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(to right, #ff0099, #ff6a00);
    }
    
    .tab-content {
      display: none;
      padding: 30px 0;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .artist-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 25px;
    }
    
    .artist-card {
      background-color: rgba(30, 30, 30, 0.75);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .artist-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 35px rgba(255, 0, 153, 0.3);
      border-color: rgba(255, 0, 153, 0.3);
    }
    
    .artist-image {
      width: 100%;
      height: 180px;
      background-size: cover;
      background-position: center;
    }
    
    .artist-info {
      padding: 20px;
    }
    
    .artist-name {
      margin: 0 0 10px 0;
      font-size: 1.3em;
      font-weight: 600;
    }
    
    .artist-specialty {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 15px;
    }
    
    .specialty-tag {
      background-color: rgba(50, 50, 50, 0.8);
      padding: 4px 10px;
      border-radius: 15px;
      font-size: 0.8em;
      color: #cccccc;
    }
    
    .view-profile-btn {
      display: block;
      text-align: center;
      padding: 8px 0;
      background: linear-gradient(135deg, #614385, #516395);
      color: white;
      text-decoration: none;
      border-radius: 20px;
      font-weight: 500;
      font-size: 0.9em;
      transition: all 0.3s ease;
    }
    
    .view-profile-btn:hover {
      background: linear-gradient(135deg, #516395, #614385);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(97, 67, 133, 0.4);
    }
    
    .review-list {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .review-card {
      background-color: rgba(30, 30, 30, 0.75);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 25px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .review-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .reviewer-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .reviewer-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      background-color: #2a2a2a;
    }
    
    .reviewer-name {
      font-weight: 600;
      color: #ffffff;
    }
    
    .review-date {
      font-size: 0.9em;
      color: #aaaaaa;
    }
    
    .review-rating {
      color: #ffcc00;
      font-size: 1.1em;
      font-weight: 600;
    }
    
    .review-title {
      font-size: 1.2em;
      font-weight: 600;
      margin: 0 0 10px 0;
      color: #ffffff;
    }
    
    .review-content {
      color: #e0e0e0;
      line-height: 1.6;
    }
    
    .guest-spot-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .guest-spot-card {
      background-color: rgba(30, 30, 30, 0.75);
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: space-between;
      align-items: center;
    }
    
    .guest-spot-info {
      flex: 1;
      min-width: 250px;
    }
    
    .guest-spot-dates {
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 10px;
    }
    
    .guest-spot-desc {
      color: #e0e0e0;
      line-height: 1.5;
    }
    
    .guest-spot-status {
      display: inline-block;
      padding: 6px 15px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: 600;
      margin-bottom: 15px;
    }
    
    .status-open {
      background: linear-gradient(135deg, #11998e, #38ef7d);
      color: white;
    }
    
    .status-confirmed {
      background: linear-gradient(135deg, #2193b0, #6dd5ed);
      color: white;
    }
    
    .status-completed {
      background: linear-gradient(135deg, #757F9A, #D7DDE8);
      color: white;
    }
    
    .guest-spot-artist {
      font-weight: 500;
    }
    
    .guest-spot-action {
      flex: 0 0 auto;
    }
    
    .review-form {
      background-color: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 30px;
      max-width: 800px;
      margin: 0 auto 30px auto;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .form-title {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 1.4em;
      color: #ffffff;
      font-weight: 600;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #e0e0e0;
    }
    
    .form-control {
      width: 100%;
      padding: 12px 15px;
      background-color: rgba(40, 40, 40, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      color: #ffffff;
      font-family: 'Poppins', sans-serif;
      font-size: 1em;
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      outline: none;
      border-color: #ff0099;
      box-shadow: 0 0 0 2px rgba(255, 0, 153, 0.2);
    }
    
    textarea.form-control {
      min-height: 120px;
      resize: vertical;
    }
    
    .star-rating {
      display: flex;
      gap: 10px;
      margin: 10px 0;
    }
    
    .star {
      color: #555555;
      font-size: 1.5em;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .star:hover, .star.selected {
      color: #ffcc00;
    }
    
    .submit-btn {
      background: linear-gradient(135deg, #ff0099, #ff6a00);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 30px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1em;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 6px 20px rgba(255, 0, 153, 0.3);
    }
    
    .submit-btn:hover {
      background: linear-gradient(135deg, #ff0099, #ff3366);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(255, 0, 153, 0.4);
    }
    
    .no-items {
      text-align: center;
      padding: 40px 20px;
      color: #cccccc;
      font-size: 1.1em;
      background-color: rgba(30, 30, 30, 0.6);
      border-radius: 15px;
    }
    

    
    @media (max-width: 768px) {
      .shop-header {
        flex-direction: column;
        gap: 0;
      }
      
      .shop-gallery, .shop-info {
        width: 100%;
      }
      
      .shop-image {
        height: 300px;
      }
      
      .tabs {
        flex-wrap: wrap;
      }
      
      .tab-button {
        flex: 1 0 auto;
        padding: 10px 15px;
        font-size: 0.9em;
      }
      
      .artist-list {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">Ink Link</div>
    <nav>
      <a href="/">Home</a>
      <a href="/artists.html">Artists</a>
      <a href="/shops.html">Shops</a>
      <a href="/guestspots.html">Guest Spots</a>
      <a href="/contact.html">Contact</a>
    </nav>
  </header>
  
  <div class="container">
    <div class="shop-header" id="shopHeader">
      <!-- Shop header content will be populated here -->
    </div>
    
    <div class="tabs">
      <button class="tab-button active" data-tab="artists">Artists</button>
      <button class="tab-button" data-tab="reviews">Reviews</button>
      <button class="tab-button" data-tab="guestspots">Guest Spots</button>
    </div>
    
    <div class="tab-content active" id="artists">
      <div class="artist-list" id="artistList">
        <!-- Artist cards will be populated here -->
      </div>
    </div>
    
    <div class="tab-content" id="reviews">
      <div class="review-form" id="reviewForm">
        <h3 class="form-title">Write a Review</h3>
        <div class="form-group">
          <label class="form-label">Rating</label>
          <div class="star-rating" id="starRating">
            <span class="star" data-rating="1">â˜…</span>
            <span class="star" data-rating="2">â˜…</span>
            <span class="star" data-rating="3">â˜…</span>
            <span class="star" data-rating="4">â˜…</span>
            <span class="star" data-rating="5">â˜…</span>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label" for="reviewTitle">Title</label>
          <input type="text" id="reviewTitle" class="form-control" placeholder="Summarize your experience">
        </div>
        <div class="form-group">
          <label class="form-label" for="reviewContent">Your Review</label>
          <textarea id="reviewContent" class="form-control" placeholder="Tell others about your experience at this shop"></textarea>
        </div>
        <button type="button" class="submit-btn" id="submitReview">Submit Review</button>
      </div>
      
      <div class="review-list" id="reviewList">
        <!-- Review cards will be populated here -->
      </div>
    </div>
    
    <div class="tab-content" id="guestspots">
      <div class="guest-spot-list" id="guestSpotList">
        <!-- Guest spot cards will be populated here -->
      </div>
    </div>
    

  </div>
  
  <script>
    // Get the shop ID from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const shopId = urlParams.get('id');
    
    // If no shop ID is provided, redirect to shops list
    if (!shopId) {
      window.location.href = '/shops.html';
    }
    
    // Tab functionality
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        // Remove active class from all buttons and contents
        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        
        // Add active class to clicked button and corresponding content
        button.classList.add('active');
        const tabId = button.getAttribute('data-tab');
        document.getElementById(tabId).classList.add('active');
      });
    });
    
    // Star rating functionality
    const stars = document.querySelectorAll('.star');
    let selectedRating = 0;
    
    stars.forEach(star => {
      star.addEventListener('click', () => {
        const rating = parseInt(star.getAttribute('data-rating'));
        selectedRating = rating;
        
        // Reset all stars
        stars.forEach(s => s.classList.remove('selected'));
        
        // Select stars up to the clicked one
        stars.forEach(s => {
          if (parseInt(s.getAttribute('data-rating')) <= rating) {
            s.classList.add('selected');
          }
        });
      });
    });
    
    // Submit review functionality
    document.getElementById('submitReview').addEventListener('click', () => {
      const title = document.getElementById('reviewTitle').value.trim();
      const content = document.getElementById('reviewContent').value.trim();
      
      if (selectedRating === 0) {
        alert('Please select a rating');
        return;
      }
      
      if (title === '') {
        alert('Please enter a review title');
        return;
      }
      
      if (content === '') {
        alert('Please enter your review');
        return;
      }
      
      // In a real app, this would send the review to the server
      alert('Thank you for your review! In a production environment, this would be saved to the database.');
      
      // Clear the form
      document.getElementById('reviewTitle').value = '';
      document.getElementById('reviewContent').value = '';
      stars.forEach(s => s.classList.remove('selected'));
      selectedRating = 0;
      
      // Add the review to the list (for demo purposes)
      addReview({
        id: 'new-' + Date.now(),
        userId: 'current-user',
        targetId: shopId,
        targetType: 'shop',
        rating: selectedRating,
        title: title,
        content: content,
        userDisplayName: 'You',
        userAvatar: '/images/artist.webp',
        created: new Date()
      });
    });
    
    // Function to add a review to the list
    function addReview(review) {
      const reviewList = document.getElementById('reviewList');
      const reviewCard = document.createElement('div');
      reviewCard.className = 'review-card';
      
      // Format the date
      const formattedDate = new Date(review.created).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
      
      // Generate stars HTML
      let starsHtml = '';
      for (let i = 1; i <= 5; i++) {
        if (i <= review.rating) {
          starsHtml += 'â˜…';
        } else {
          starsHtml += 'â˜†';
        }
      }
      
      // Create HTML content for the review card
      reviewCard.innerHTML = `
        <div class="review-header">
          <div class="reviewer-info">
            <div class="reviewer-avatar" style="background-image: url('${review.userAvatar || '/images/artist.webp'}');"></div>
            <div>
              <div class="reviewer-name">${review.userDisplayName}</div>
              <div class="review-date">${formattedDate}</div>
            </div>
          </div>
          <div class="review-rating">${starsHtml}</div>
        </div>
        <h4 class="review-title">${review.title}</h4>
        <div class="review-content">${review.content}</div>
      `;
      
      // Add to the beginning of the list
      if (reviewList.firstChild) {
        reviewList.insertBefore(reviewCard, reviewList.firstChild);
      } else {
        reviewList.appendChild(reviewCard);
      }
    }
    
    // Fetch shop data from the API
    fetch(`/.netlify/functions/parlors/${shopId}`)
      .then(response => response.json())
      .then(result => {
        // Handle both formats (direct shop object or {success, data})
        const shop = result.success && result.data ? result.data : result;
        
        if (!shop) {
          window.location.href = '/shops.html';
          return;
        }
        
        // Set page title
        document.title = `${shop.name} - Ink Link`;
        
        // Populate shop header
        const shopHeader = document.getElementById('shopHeader');
        
        shopHeader.innerHTML = `
          <div class="shop-gallery">
            <div class="shop-image" style="background-image: url('/images/shop.jpeg');"></div>
            <div class="gallery-nav">
              <div class="gallery-dot active"></div>
              ${shop.images ? shop.images.map((_, index) => `<div class="gallery-dot"></div>`).join('') : ''}
            </div>
          </div>
          <div class="shop-info">
            <h1 class="shop-name">${shop.name}</h1>
            <div class="shop-location">
              ${shop.location ? 
                `${shop.location.city || ''}, ${shop.location.state || ''}, ${shop.location.country || 'USA'}` : 
                'Location information not available'}
            </div>
            <div class="badge-container">
              ${shop.featured ? '<span class="featured-badge">Featured</span>' : ''}
              ${shop.sponsored ? '<span class="sponsored-badge">Sponsored</span>' : ''}
            </div>
            <div class="shop-rating">
              ${(shop.rating ? (shop.rating / 10).toFixed(1) : '0.0')}
              <span class="review-count">(${shop.review_count || shop.reviewCount || 0} reviews)</span>
            </div>
            <p class="shop-description">${shop.description || 'A premier tattoo destination showcasing talented artists in a clean, professional environment.'}</p>
            
            <div class="detail-section">
              <div class="detail-title">Location</div>
              <ul class="contact-list">
                <li>${shop.location ? shop.location.address || 'Address not available' : 'Address not available'}</li>
                <li>${shop.location ? `${shop.location.city || ''}, ${shop.location.state || ''} ${shop.location.postalCode || ''}` : 'City, State information not available'}</li>
                <li>${shop.location ? shop.location.country || 'USA' : 'USA'}</li>
              </ul>
            </div>
            
            <div class="detail-section">
              <div class="detail-title">Contact</div>
              <ul class="contact-list">
                <li>Phone: ${shop.contact && shop.contact.phone ? shop.contact.phone : 'Not available'}</li>
                <li>Email: ${shop.contact && shop.contact.email ? shop.contact.email : 'Not available'}</li>
                <li>Website: ${shop.contact && shop.contact.website ? 
                  `<a href="${shop.contact.website}" target="_blank" rel="noopener">${shop.contact.website.replace(/^https?:\/\//, '')}</a>` : 
                  'Not available'}</li>
              </ul>
            </div>
            
            <!-- Hours and amenities sections removed to avoid showing unverified data -->
            
            <div class="detail-section">
              <div class="detail-title">Social</div>
              <ul class="social-list">
                ${shop.social && shop.social.instagram ? 
                  `<li><a href="https://instagram.com/${shop.social.instagram.replace('@', '')}" target="_blank" class="social-link">Instagram</a></li>` : 
                  ''}
                ${shop.contact && shop.contact.website ? 
                  `<li><a href="${shop.contact.website}" target="_blank" class="social-link">Website</a></li>` : 
                  ''}
              </ul>
            </div>
            
            <div class="action-buttons">
              <button class="action-button primary-button">Book Appointment</button>
              <button class="action-button secondary-button" onclick="shareShop('${shop.name}')">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="18" cy="5" r="3"></circle>
                  <circle cx="6" cy="12" r="3"></circle>
                  <circle cx="18" cy="19" r="3"></circle>
                  <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                  <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                </svg>
                Share
              </button>
            </div>
          </div>
        `;
        
        // Add gallery functionality (if we had real images)
        const galleryDots = document.querySelectorAll('.gallery-dot');
        const shopImage = document.querySelector('.shop-image');
        
        // Use real shop image as requested
        const shopImages = [
          '/images/shop.jpeg',
          '/images/shop.jpeg',
          '/images/shop.jpeg'
        ];
        
        galleryDots.forEach((dot, index) => {
          dot.addEventListener('click', () => {
            // Remove active class from all dots
            galleryDots.forEach(d => d.classList.remove('active'));
            
            // Add active class to clicked dot
            dot.classList.add('active');
            
            // Change the background image
            shopImage.style.backgroundImage = `url('${shopImages[index]}')`;
          });
        });
      })
      .catch(error => {
        console.error('Error fetching shop:', error);
        alert('Error loading shop details. Please try again later.');
        window.location.href = '/shops.html';
      });
    
    // Fetch artists for this shop
    fetch('/.netlify/functions/artists')
      .then(response => response.json())
      .then(result => {
        // Handle both formats (direct array or {success, data})
        const artists = result.success && Array.isArray(result.data) ? result.data : result;
        // For demo purposes, we'll filter 3 random artists
        const filteredArtists = artists.slice(0, 3);
        const artistList = document.getElementById('artistList');
        
        if (filteredArtists.length === 0) {
          artistList.innerHTML = '<div class="no-items">No artists are currently associated with this shop.</div>';
          return;
        }
        
        filteredArtists.forEach(artist => {
          const artistCard = document.createElement('div');
          artistCard.className = 'artist-card';
          
          // Create HTML content for the artist card
          artistCard.innerHTML = `
            <div class="artist-image" style="background-image: url('/images/artist.webp');"></div>
            <div class="artist-info">
              <h3 class="artist-name">${artist.name}</h3>
              <div class="artist-specialty">
                ${artist.specialty && Array.isArray(artist.specialty) ? 
                    artist.specialty.map(spec => `<span class="specialty-tag">${spec}</span>`).join('') : 
                    '<span class="specialty-tag">Tattoo Artist</span>'}
              </div>
              <a href="/artist-detail.html?id=${artist.id}" class="view-profile-btn">View Profile</a>
            </div>
          `;
          
          artistList.appendChild(artistCard);
        });
      })
      .catch(error => {
        console.error('Error fetching artists:', error);
        document.getElementById('artistList').innerHTML = '<div class="no-items">Error loading artists. Please try again later.</div>';
      });
    
    // Setup the reviews section
    const reviewList = document.getElementById('reviewList');
    reviewList.innerHTML = '<div class="no-items">No reviews yet. Be the first to leave one!</div>';
    
    // Fetch guest spots for this shop
    fetch('/.netlify/functions/guestspots')
      .then(response => response.json())
      .then(result => {
        // Handle both formats (direct array or {success, data})
        const guestspots = result.success && Array.isArray(result.data) ? result.data : result;
        // Filter guest spots for this shop
        const shopGuestspots = guestspots.filter(spot => spot.parlorId === shopId);
        const guestSpotList = document.getElementById('guestSpotList');
        
        if (shopGuestspots.length === 0) {
          guestSpotList.innerHTML = '<div class="no-items">No guest spots are currently available at this shop.</div>';
          return;
        }
        
        shopGuestspots.forEach(spot => {
          const guestspotCard = document.createElement('div');
          guestspotCard.className = 'guest-spot-card';
          
          // Format the date range
          const startDate = new Date(spot.dateStart);
          const endDate = new Date(spot.dateEnd);
          const dateOptions = { month: 'short', day: 'numeric', year: 'numeric' };
          const dateRange = `${startDate.toLocaleDateString('en-US', dateOptions)} - ${endDate.toLocaleDateString('en-US', dateOptions)}`;
          
          // Create button based on status
          let buttonHTML = '';
          if (spot.status.toLowerCase() === 'open') {
            buttonHTML = '<button class="action-button primary-button">Apply Now</button>';
          } else if (spot.status.toLowerCase() === 'confirmed') {
            buttonHTML = '<div class="guest-spot-artist">Artist: <strong>' + (spot.artistName || 'TBA') + '</strong></div>';
          } else {
            buttonHTML = '';
          }
          
          // Create HTML content for the guestspot card
          guestspotCard.innerHTML = `
            <div class="guest-spot-info">
              <span class="guest-spot-status status-${spot.status.toLowerCase()}">${spot.status.toUpperCase()}</span>
              <div class="guest-spot-dates">${dateRange}</div>
              <div class="guest-spot-desc">${spot.description || 'No additional details provided.'}</div>
            </div>
            <div class="guest-spot-action">
              ${buttonHTML}
            </div>
          `;
          
          guestSpotList.appendChild(guestspotCard);
        });
      })
      .catch(error => {
        console.error('Error fetching guestspots:', error);
        document.getElementById('guestSpotList').innerHTML = '<div class="no-items">Error loading guest spots. Please try again later.</div>';
      });
    
    // Share shop function
    function shareShop(shopName) {
      if (navigator.share) {
        navigator.share({
          title: 'Check out this tattoo shop on Ink Link',
          text: `I found ${shopName} on Ink Link, the tattoo artist & shop directory!`,
          url: window.location.href,
        })
        .then(() => console.log('Share successful'))
        .catch((error) => console.log('Error sharing:', error));
      } else {
        // Fallback for browsers that don't support the Web Share API
        alert(`Share this shop: ${window.location.href}`);
      }
    }
    
    // Share shop functionality
    function shareShop(shopName) {
      if (navigator.share) {
        navigator.share({
          title: `${shopName} - Ink Link`,
          text: `Check out ${shopName} on Ink Link!`,
          url: window.location.href,
        })
        .catch(error => console.log('Error sharing:', error));
      } else {
        alert(`Share this shop: ${window.location.href}`);
      }
    }
  </script>
</body>
</html>