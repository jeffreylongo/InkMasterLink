<!DOCTYPE html>
<html>
<head>
  <title>Apply for Guest Spot - Ink Link</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #121212;
      color: #f1f1f1;
      margin: 0;
      padding: 0;
      background-image: linear-gradient(rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.85)), url('https://images.unsplash.com/photo-1598971861077-67a649437286?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1770&q=80');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
    header {
      text-align: center;
      padding: 30px 0;
      background-color: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.4);
      position: relative;
      z-index: 10;
    }
    .logo {
      font-family: 'Permanent Marker', cursive;
      font-size: 3em;
      margin-bottom: 10px;
      color: #ffffff;
      text-shadow: 
        0 0 10px #ff0099,
        0 0 20px #ff0099;
    }
    nav {
      margin-top: 10px;
    }
    nav a {
      margin: 0 15px;
      color: #ffffff;
      text-decoration: none;
      font-weight: 500;
      font-size: 1.1em;
      position: relative;
      transition: all 0.3s;
    }
    nav a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -5px;
      left: 0;
      background-color: #ff0099;
      transition: width 0.3s ease;
    }
    nav a:hover {
      color: #ff0099;
    }
    nav a:hover::after {
      width: 100%;
    }
    
    .container {
      max-width: 1000px;
      margin: 40px auto;
      padding: 0 20px;
    }
    
    .page-title {
      font-size: 2em;
      margin: 0 0 30px 0;
      color: #ffffff;
      text-align: center;
      font-weight: 600;
      letter-spacing: 1px;
      text-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
    }
    
    .guestspot-header {
      background-color: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 40px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .spot-details {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 20px;
    }
    
    .shop-info {
      flex: 1;
      min-width: 300px;
    }
    
    .shop-name {
      font-size: 1.8em;
      margin: 0 0 10px 0;
      color: #ffffff;
      font-weight: 600;
    }
    
    .shop-location {
      color: #cccccc;
      margin-bottom: 15px;
      font-size: 1.05em;
    }
    
    .date-info {
      flex: 0 0 auto;
      text-align: right;
    }
    
    .date-range {
      font-weight: 600;
      color: #ffffff;
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    
    .status {
      display: inline-block;
      padding: 8px 20px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: 600;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    .status-open {
      background: linear-gradient(135deg, #11998e, #38ef7d);
      color: white;
      box-shadow: 0 4px 10px rgba(17, 153, 142, 0.3);
    }
    
    .guestspot-description {
      margin-top: 20px;
      color: #e0e0e0;
      line-height: 1.6;
      font-size: 1.05em;
    }
    
    .requirements {
      margin-top: 20px;
    }
    
    .section-title {
      color: #ff0099;
      font-weight: 600;
      margin-bottom: 10px;
      font-size: 1.2em;
    }
    
    .application-form {
      background-color: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .form-title {
      font-size: 1.5em;
      margin: 0 0 30px 0;
      color: #ffffff;
      font-weight: 600;
      text-align: center;
    }
    
    .form-group {
      margin-bottom: 25px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #e0e0e0;
    }
    
    .form-control {
      width: 100%;
      padding: 15px;
      background-color: rgba(40, 40, 40, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      color: #ffffff;
      font-family: 'Poppins', sans-serif;
      font-size: 1em;
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      outline: none;
      border-color: #ff0099;
      box-shadow: 0 0 0 2px rgba(255, 0, 153, 0.2);
    }
    
    textarea.form-control {
      min-height: 150px;
      resize: vertical;
    }
    
    .portfolio-section {
      margin-bottom: 30px;
    }
    
    .portfolio-images {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .portfolio-item {
      width: 100%;
      height: 0;
      padding-bottom: 100%;
      position: relative;
      border-radius: 10px;
      overflow: hidden;
      background-color: rgba(50, 50, 50, 0.8);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .portfolio-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    }
    
    .portfolio-img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .portfolio-add {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: #cccccc;
      font-size: 2em;
    }
    
    .portfolio-add span {
      font-size: 0.4em;
      margin-top: 5px;
    }
    
    .submit-btn {
      background: linear-gradient(135deg, #ff0099, #ff6a00);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 30px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1.1em;
      transition: all 0.3s ease;
      display: block;
      width: 100%;
      max-width: 300px;
      margin: 0 auto;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 6px 20px rgba(255, 0, 153, 0.3);
    }
    
    .submit-btn:hover {
      background: linear-gradient(135deg, #ff0099, #ff3366);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(255, 0, 153, 0.4);
    }
    
    .file-upload {
      display: none;
    }
    
    .back-link {
      display: inline-block;
      margin-top: 30px;
      color: #cccccc;
      text-decoration: none;
      transition: all 0.3s ease;
    }
    
    .back-link:hover {
      color: #ffffff;
    }
    
    .back-link::before {
      content: '‚Üê';
      margin-right: 8px;
    }
    
    @media (max-width: 768px) {
      .spot-details {
        flex-direction: column;
      }
      .date-info {
        text-align: left;
      }
      .portfolio-images {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      }
      .application-form {
        padding: 30px 20px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">Ink Link</div>
    <nav>
      <a href="/">Home</a>
      <a href="/artists.html">Artists</a>
      <a href="/shops.html">Shops</a>
      <a href="/guestspots.html">Guest Spots</a>
    </nav>
  </header>
  
  <div class="container">
    <h1 class="page-title">Apply for Guest Spot</h1>
    
    <div class="guestspot-header" id="guestspotHeader">
      <!-- Guestspot details will be populated here -->
    </div>
    
    <div class="application-form">
      <h2 class="form-title">Submit Your Application</h2>
      
      <div class="form-group">
        <label class="form-label" for="message">Your Message</label>
        <textarea id="message" class="form-control" placeholder="Introduce yourself and explain why you would be a good fit for this guest spot..."></textarea>
      </div>
      
      <div class="portfolio-section">
        <label class="form-label">Portfolio Examples</label>
        <p>Please share examples of your work that are relevant to this opportunity.</p>
        
        <div class="portfolio-images" id="portfolioImages">
          <div class="portfolio-item portfolio-add" id="addPortfolioItem">
            +
            <span>Add Image</span>
          </div>
        </div>
        
        <input type="file" class="file-upload" id="fileUpload" accept="image/*" multiple>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="contact">Contact Information</label>
        <input type="text" id="contact" class="form-control" placeholder="Email or phone number">
      </div>
      
      <div class="form-group">
        <label class="form-label" for="instagram">Instagram Username (optional)</label>
        <input type="text" id="instagram" class="form-control" placeholder="@yourusername">
      </div>
      
      <button type="button" id="submitApplication" class="submit-btn">Submit Application</button>
    </div>
    
    <a href="/guestspots.html" class="back-link">Back to Guest Spots</a>
  </div>
  
  <script>
    // Get the guestspot ID from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const guestspotId = urlParams.get('id');
    
    // If no guestspot ID is provided, redirect to guestspot list
    if (!guestspotId) {
      window.location.href = '/guestspots.html';
    }
    
    // Fetch the guestspot details
    fetch('/api/guestspots')
      .then(response => response.json())
      .then(guestspots => {
        const guestspot = guestspots.find(spot => spot.id === guestspotId);
        
        if (!guestspot) {
          alert('Guest spot not found.');
          window.location.href = '/guestspots.html';
          return;
        }
        
        if (guestspot.status.toLowerCase() !== 'open') {
          alert('This guest spot is no longer accepting applications.');
          window.location.href = '/guestspots.html';
          return;
        }
        
        // Format the date range
        const startDate = new Date(guestspot.dateStart);
        const endDate = new Date(guestspot.dateEnd);
        const dateOptions = { month: 'long', day: 'numeric', year: 'numeric' };
        const dateRange = `${startDate.toLocaleDateString('en-US', dateOptions)} - ${endDate.toLocaleDateString('en-US', dateOptions)}`;
        
        // Populate the guestspot header
        const guestspotHeader = document.getElementById('guestspotHeader');
        
        guestspotHeader.innerHTML = `
          <div class="spot-details">
            <div class="shop-info">
              <h2 class="shop-name">${guestspot.parlorName}</h2>
              <div class="shop-location">${guestspot.parlorLocation.city}, ${guestspot.parlorLocation.state}, ${guestspot.parlorLocation.country}</div>
            </div>
            <div class="date-info">
              <div class="date-range">${dateRange}</div>
              <span class="status status-${guestspot.status.toLowerCase()}">${guestspot.status.toUpperCase()}</span>
            </div>
          </div>
          <div class="guestspot-description">
            ${guestspot.description || 'No additional details provided.'}
          </div>
          ${guestspot.requirements ? `
          <div class="requirements">
            <div class="section-title">Requirements</div>
            <div>${guestspot.requirements}</div>
          </div>
          ` : ''}
        `;
      })
      .catch(error => {
        console.error('Error fetching guestspot:', error);
        alert('Error loading guest spot details. Please try again later.');
        window.location.href = '/guestspots.html';
      });
    
    // Portfolio image handling
    const fileUpload = document.getElementById('fileUpload');
    const addPortfolioItem = document.getElementById('addPortfolioItem');
    const portfolioImages = document.getElementById('portfolioImages');
    
    addPortfolioItem.addEventListener('click', () => {
      fileUpload.click();
    });
    
    fileUpload.addEventListener('change', (e) => {
      const files = e.target.files;
      
      if (files.length === 0) return;
      
      // Process each selected file
      for (let i = 0; i < files.length; i++) {
        if (i >= 5) break; // Limit to 5 images
        
        const file = files[i];
        const reader = new FileReader();
        
        reader.onload = function(event) {
          const portfolioItem = document.createElement('div');
          portfolioItem.className = 'portfolio-item';
          
          const img = document.createElement('img');
          img.src = event.target.result;
          img.className = 'portfolio-img';
          
          portfolioItem.appendChild(img);
          portfolioImages.insertBefore(portfolioItem, addPortfolioItem);
          
          // Add click event to remove image
          portfolioItem.addEventListener('click', () => {
            if (confirm('Remove this image?')) {
              portfolioImages.removeChild(portfolioItem);
            }
          });
        };
        
        reader.readAsDataURL(file);
      }
      
      // Reset file input
      fileUpload.value = '';
    });
    
    // Submit application
    document.getElementById('submitApplication').addEventListener('click', () => {
      const message = document.getElementById('message').value.trim();
      const contact = document.getElementById('contact').value.trim();
      const instagram = document.getElementById('instagram').value.trim();
      
      // Get all portfolio images except the add button
      const portfolioItems = document.querySelectorAll('.portfolio-img');
      
      if (message === '') {
        alert('Please enter a message.');
        return;
      }
      
      if (portfolioItems.length === 0) {
        alert('Please add at least one portfolio image.');
        return;
      }
      
      if (contact === '') {
        alert('Please provide contact information.');
        return;
      }
      
      // In a real app, this would send the application to the server
      alert('Thank you for your application! In a production environment, this would be sent to the shop owner for review.');
      
      // Redirect back to guestspots list
      window.location.href = '/guestspots.html';
    });
  </script>
</body>
</html>